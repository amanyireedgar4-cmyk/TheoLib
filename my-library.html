<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Library ‚Äî TheoLib</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyC7LjxapWLQCW_zLRCOZS25hWVEaOG1mFY",
  authDomain: "theolib-426cf.firebaseapp.com",
  projectId: "theolib-426cf",
  storageBucket: "theolib-426cf.appspot.com",
  messagingSenderId: "879359514394",
  appId: "1:879359514394:web:259ad5ed2e8949e2e97ea3"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.onload = () => {
  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      document.getElementById("content").innerHTML = `
        <div class="locked">
          <h2>üîí Sign in required</h2>
          <p>Please log in to view your library.</p>
          <a href="index.html">Go back</a>
        </div>
      `;
      return;
    }

    loadBooks(user.uid);
  });
};

async function loadBooks(uid){
  const q = query(collection(db, "userBooks"), where("uid", "==", uid));
  const snap = await getDocs(q);

  const saved = document.getElementById("savedBooks");
  const read = document.getElementById("readBooks");

  saved.innerHTML = "";
  read.innerHTML = "";

  snap.forEach(doc => {
    const b = doc.data();
    const card = `
      <div class="book-card">
        <img src="${b.cover}">
        <h4>${b.title}</h4>
        <p>${b.author}</p>
        <a href="${b.link}" target="_blank">Open</a>
      </div>
    `;

    if(b.status === "saved") saved.innerHTML += card;
    if(b.status === "read") read.innerHTML += card;
  });
}
</script>

<style>
:root{
  --bg:#0b0f1a;
  --panel:#12172a;
  --accent:#4cc9f0;
  --text:#e5e7eb;
  --muted:#9ca3af;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter, Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}

nav{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:18px 28px;
  background:#050814;
}
nav h2{color:var(--accent);margin:0}
nav a{
  color:var(--text);
  text-decoration:none;
  margin-left:18px;
}
nav a:hover{color:var(--accent)}

section{
  max-width:1200px;
  margin:auto;
  padding:50px 20px;
}

h2{color:var(--accent);margin-bottom:10px}
h3{margin-top:60px}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:22px;
  margin-top:20px;
}

.book-card{
  background:var(--panel);
  padding:16px;
  border-radius:16px;
  transition:.3s;
}
.book-card:hover{
  transform:translateY(-6px);
  box-shadow:0 18px 35px rgba(0,0,0,.4);
}
.book-card img{
  width:100%;
  height:280px;
  object-fit:cover;
  border-radius:10px;
  margin-bottom:10px;
}
.book-card h4{margin:0 0 6px}
.book-card p{color:var(--muted);font-size:14px;margin:0 0 10px}
.book-card a{color:var(--accent);text-decoration:none}

.locked{
  text-align:center;
  padding:120px 20px;
}
.locked a{
  color:var(--accent);
  text-decoration:none;
  font-size:15px;
}

footer{
  background:#050814;
  padding:30px;
  text-align:center;
  color:var(--muted);
  font-size:13px;
}
</style>
</head>

<body>

<nav>
  <h2>TheoLib</h2>
  <div>
    <a href="index.html">Home</a>
    <a href="library.html">Library</a>
    <a href="my-library.html">My Library</a>
    <a href="community.html">Community</a>
  </div>
</nav>

<div id="content">
<section>
  <h2>üìö My Library</h2>
  <p style="color:var(--muted)">Your saved and read books.</p>

  <h3>‚≠ê Saved Books</h3>
  <div id="savedBooks" class="grid"></div>

  <h3>üìñ Read Books</h3>
  <div id="readBooks" class="grid"></div>
</section>
</div>

<footer>
TheoLib ¬© 2026 ¬∑ Knowledge is a human right
</footer>

</body>
</html>
